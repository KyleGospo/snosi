# tmpfiles.d configuration for Nix package manager
# Creates the /nix hierarchy and persistent store directories, and copies
# factory /etc/nix configuration at boot if not already present.

# /nix root directory - writable persistent storage (NOT in /usr)
# Will be bind-mounted from /var/lib/nix at runtime
d /nix 0755 root root - -

# Persistent Nix store location under /var/lib
d /var/lib/nix 0755 nixbld nixbld - -
d /var/lib/nix/store 0755 nixbld nixbld - -

# User profiles - world-writable so any user can create profiles
d /var/lib/nix/profiles 1777 root root - -

# Garbage collection roots - world-writable so any user can register GC roots
d /var/lib/nix/gcroots 1777 root root - -

# Copy factory /etc/nix configuration on first boot if not already present
C /etc/nix - - - - -
